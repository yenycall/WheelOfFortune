<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tarot Game</title>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css');

        body {
            font-family: 'pretendard', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            width: 90vw;
            margin: 0 auto;
            padding: 2vw 0;
        }

        .gameSection {
            width: 90%;
            min-height: 45vw;
            border-radius: 1.5vw;
            margin: 7vw auto;
            display: flex;
            justify-content: center;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .hidden {
            display: none !important;
        }

        .stage {
            display: flex;
            align-items: flex-start;
            justify-content: center;
            text-align: center;
            flex-direction: column;
            width: 100%;
            padding: 2vw;
            position: relative;
            z-index: 2;
            min-height: 41vw;
        }

        .stage.intro-stage {
            align-items: center;
            justify-content: center;
        }

        /* 배경 이미지 스타일 */
        .movie01 {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 1.5vw;
            filter: grayscale(100%) brightness(0.7);
            z-index: 1;
        }

        .stage::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 1.5vw;
            z-index: 1;
        }

        .stage > * {
            position: relative;
            z-index: 3;
        }

        .stage-title img {
            width: 17vw;
            margin-bottom: 1vw;
        }

        .stage-description {
            font-size: 1.2vw;
            margin-bottom: 2vw;
            line-height: 1.6vw;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            max-width: 60vw;
        }

        /* 카드 컨테이너 스타일 */
        .cards-container {
            display: flex;
            gap: 2vw;
            justify-content: center;
            margin: 2vw 0;
            transition: all 0.8s ease;
            width: 100%;
        }

        .cards-container.selected-state {
            justify-content: flex-start;
            align-items: flex-start;
        }

        /* 카드 스타일 */
        .card {
            width: 8vw;
            height: 12vw;
            perspective: 1000px;
            cursor: pointer;
            transition: all 0.8s ease;
        }

        .card.selected {
            margin-right: 2vw;
        }

        .card.hidden {
            opacity: 0;
            transform: scale(0) translateY(-50px);
            pointer-events: none;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s;
            transform-style: preserve-3d;
        }

        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 0.8vw;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .card-front {
            transform: rotateY(180deg);
        }

        .card-back {
            transform: rotateY(0deg);
        }

        /* 게임 콘텐츠 레이아웃 */
        .game-content {
            display: flex;
            align-items: flex-start;
            gap: 2vw;
            width: 100%;
            margin-top: 1vw;
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.8s ease;
        }

        .game-content.show {
            opacity: 1;
            transform: translateX(0);
        }

        .story-and-actions {
            flex: 1;
            text-align: left;
            display: flex;
            flex-direction: column;
            gap: 1.5vw;
        }

        .story-text {
            background: rgba(255, 255, 255, 0.95);
            padding: 1.5vw;
            border-radius: 1vw;
            font-size: 1vw;
            line-height: 1.6vw;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .action-choices {
            display: flex;
            flex-direction: column;
            gap: 0.8vw;
        }

        .action-choice {
            background: rgba(255, 255, 255, 0.9);
            padding: 1vw 1.5vw;
            border-radius: 0.8vw;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            font-size: 1vw;
            line-height: 1.4vw;
        }

        .action-choice:hover {
            background: rgba(171, 255, 0, 0.8);
            transform: translateX(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border-color: rgba(0, 0, 0, 0.1);
        }

        .action-choice.selected {
            background: rgba(171, 255, 0, 0.9);
            border-color: #333;
            transform: translateX(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        /* 버튼 스타일 */
        button {
            background: linear-gradient(180deg, #E5FFB0, #ABFF00);
            color: #212121;
            border: 0.1vw solid #000;
            padding: 0.8vw 2vw;
            font-size: 1.2vw;
            font-weight: 600;
            border-radius: 3vw;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 1vw;
        }

        button:hover {
            transform: translateY(-0.2vw);
            box-shadow: 0 0.4vw 0.8vw rgba(0, 0, 0, 0.25);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .buttons {
            margin-top: 2vw;
        }

        /* 엔딩 섹션 */
        .ending-section {
            text-align: center;
            padding: 3vw;
        }

        .ending-text {
            background: rgba(255, 255, 255, 0.9);
            padding: 2vw;
            border-radius: 1vw;
            font-size: 1.1vw;
            line-height: 1.6vw;
            white-space: pre-line;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        /* 시작 화면 */
        .stage-start img {
            width: 40vw;
            margin-bottom: 2vw;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="gameSection">
            <!-- 시작 화면 -->
            <div id="intro" class="stage intro-stage">
                <div class="stage-start">
                    <h1 style="color: white; font-size: 3vw; margin-bottom: 2vw;">타로 운명 게임</h1>
                </div>
                <button id="start-button">게임 시작</button>
            </div>

            <!-- 게임 스테이지 -->
            <div id="game-stage" class="stage hidden">
                <img class="movie01" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%232c3e50'/%3E%3Cstop offset='100%25' style='stop-color:%23bdc3c7'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='800' height='600' fill='url(%23grad)'/%3E%3Ctext x='400' y='300' text-anchor='middle' fill='white' font-size='24' font-family='Arial'%3E타이타닉 배경 이미지%3C/text%3E%3C/svg%3E">
                
                <div class="stage-title" id="stage-title">
                    <h2 style="color: white; font-size: 2vw; margin-bottom: 1vw;">제1장: 시작의 문</h2>
                </div>

                <div class="stage-description" id="stage-description">
                    타이타닉 호의 침몰 예언 후 항구로 뛰어간 당신!<br>
                    당신은 출항 직전의 배를 발견한 후 선장을 찾아 달려갑니다.<br>
                    선장에게 어떤 말을 할까요?
                </div>

                <div class="cards-container" id="cards-container">
                    <!-- 카드들이 동적으로 생성됩니다 -->
                </div>

                <div class="game-content" id="game-content">
                    <div class="story-and-actions">
                        <div class="story-text hidden" id="story-text"></div>
                        <div class="action-choices hidden" id="action-choices">
                            <!-- 행동 선택지가 동적으로 생성됩니다 -->
                        </div>
                    </div>
                </div>

                <div class="buttons">
                    <button id="next-button" disabled>다음 스테이지</button>
                </div>
            </div>

            <!-- 엔딩 화면 -->
            <div id="ending" class="stage hidden">
                <div class="ending-section">
                    <h2 style="color: white; margin-bottom: 2vw;">게임 완료!</h2>
                    <div class="ending-text" id="ending-text">
                        축하합니다! 당신은 타이타닉의 운명을 바꿨습니다.
                        당신의 선택들이 새로운 미래를 열었습니다.
                    </div>
                    <button id="restart-button">다시 시작</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 타로카드 데이터
        const tarotCards = [
            { 
                id: 0, 
                name: "바보", 
                symbol: "🃏",
                frontImage: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 200'%3E%3Crect width='150' height='200' fill='%23ff6b6b'/%3E%3Ctext x='75' y='100' text-anchor='middle' fill='white' font-size='40'%3E🃏%3C/text%3E%3Ctext x='75' y='150' text-anchor='middle' fill='white' font-size='14'%3E바보%3C/text%3E%3C/svg%3E",
                backImage: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 200'%3E%3Cdefs%3E%3ClinearGradient id='back' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%234facfe'/%3E%3Cstop offset='100%25' style='stop-color:%2300f2fe'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='150' height='200' fill='url(%23back)'/%3E%3Ctext x='75' y='100' text-anchor='middle' fill='white' font-size='30'%3E🔮%3C/text%3E%3Ctext x='75' y='130' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3ETAROT%3C/text%3E%3C/svg%3E"
            },
            { 
                id: 1, 
                name: "마법사", 
                symbol: "✨",
                frontImage: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 200'%3E%3Crect width='150' height='200' fill='%23845ec2'/%3E%3Ctext x='75' y='100' text-anchor='middle' fill='white' font-size='40'%3E✨%3C/text%3E%3Ctext x='75' y='150' text-anchor='middle' fill='white' font-size='14'%3E마법사%3C/text%3E%3C/svg%3E",
                backImage: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 200'%3E%3Cdefs%3E%3ClinearGradient id='back' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%234facfe'/%3E%3Cstop offset='100%25' style='stop-color:%2300f2fe'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='150' height='200' fill='url(%23back)'/%3E%3Ctext x='75' y='100' text-anchor='middle' fill='white' font-size='30'%3E🔮%3C/text%3E%3Ctext x='75' y='130' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3ETAROT%3C/text%3E%3C/svg%3E"
            },
            { 
                id: 2, 
                name: "여사제", 
                symbol: "🌙",
                frontImage: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 200'%3E%3Crect width='150' height='200' fill='%23b39bc8'/%3E%3Ctext x='75' y='100' text-anchor='middle' fill='white' font-size='40'%3E🌙%3C/text%3E%3Ctext x='75' y='150' text-anchor='middle' fill='white' font-size='14'%3E여사제%3C/text%3E%3C/svg%3E",
                backImage: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 200'%3E%3Cdefs%3E%3ClinearGradient id='back' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%234facfe'/%3E%3Cstop offset='100%25' style='stop-color:%2300f2fe'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='150' height='200' fill='url(%23back)'/%3E%3Ctext x='75' y='100' text-anchor='middle' fill='white' font-size='30'%3E🔮%3C/text%3E%3Ctext x='75' y='130' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3ETAROT%3C/text%3E%3C/svg%3E"
            },
            { 
                id: 18, 
                name: "달", 
                symbol: "🌕",
                frontImage: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 200'%3E%3Crect width='150' height='200' fill='%23f093fb'/%3E%3Ctext x='75' y='100' text-anchor='middle' fill='white' font-size='40'%3E🌕%3C/text%3E%3Ctext x='75' y='150' text-anchor='middle' fill='white' font-size='14'%3E달%3C/text%3E%3C/svg%3E",
                backImage: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 200'%3E%3Cdefs%3E%3ClinearGradient id='back' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%234facfe'/%3E%3Cstop offset='100%25' style='stop-color:%2300f2fe'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='150' height='200' fill='url(%23back)'/%3E%3Ctext x='75' y='100' text-anchor='middle' fill='white' font-size='30'%3E🔮%3C/text%3E%3Ctext x='75' y='130' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3ETAROT%3C/text%3E%3C/svg%3E"
            }
        ];

        // 스테이지 데이터
        const stages = [
            {
                title: "제1장: 시작의 문",
                description: "타이타닉 호의 침몰 예언 후 항구로 뛰어간 당신!<br>당신은 출항 직전의 배를 발견한 후 선장을 찾아 달려갑니다.<br>선장에게 어떤 말을 할까요?",
                cards: [0, 1, 2, 18],
                stories: {
                    0: "당신은 절벽 앞에 서 있습니다. 망설임 없이 뛰어내리자 신비한 바람이 당신을 감싸 안았습니다. 무모해 보이는 선택이 때로는 가장 큰 가능성을 열어줍니다.",
                    1: "눈앞에 신비한 문이 나타납니다. 문을 열자 빛의 세계가 펼쳐집니다. 당신은 자신의 힘으로 운명을 창조할 수 있는 능력을 가지고 있습니다.",
                    2: "고요한 숲속, 달빛 아래 당신은 비밀의 책을 발견합니다. 그 안에는 당신만이 읽을 수 있는 지혜가 담겨 있습니다. 직관을 따르는 여정이 시작됩니다.",
                    18: "달빛이 바다를 비추고 있습니다. 당신은 신비로운 환상 속에서 진실을 찾아야 합니다. 직관과 꿈의 세계가 당신을 안내할 것입니다."
                },
                actions: {
                    0: [
                        { text: "절벽에서 뛰어내린다" },
                        { text: "다른 길을 찾아본다" },
                        { text: "절벽 위에서 명상한다" }
                    ],
                    1: [
                        { text: "문을 열고 들어간다" },
                        { text: "문의 틈새로 먼저 살펴본다" },
                        { text: "문에 새겨진 문양을 연구한다" }
                    ],
                    2: [
                        { text: "책을 펼쳐 읽는다" },
                        { text: "책을 달빛에 비춰본다" },
                        { text: "책을 소중히 간직한다" }
                    ],
                    18: [
                        { text: "달빛의 안내를 따른다" },
                        { text: "환상을 무시하고 현실에 집중한다" },
                        { text: "꿈과 현실의 경계를 탐험한다" }
                    ]
                }
            }
        ];

        // 게임 상태
        let gameState = {
            currentStage: 0,
            selectedCards: [],
            selectedActions: []
        };

        // DOM 요소
        const introSection = document.getElementById('intro');
        const gameStageSection = document.getElementById('game-stage');
        const endingSection = document.getElementById('ending');
        const stageTitle = document.getElementById('stage-title');
        const stageDescription = document.getElementById('stage-description');
        const cardsContainer = document.getElementById('cards-container');
        const gameContent = document.getElementById('game-content');
        const storyText = document.getElementById('story-text');
        const actionChoices = document.getElementById('action-choices');
        const nextButton = document.getElementById('next-button');
        const startButton = document.getElementById('start-button');
        const restartButton = document.getElementById('restart-button');
        const endingText = document.getElementById('ending-text');

        // 이벤트 리스너
        startButton.addEventListener('click', startGame);
        nextButton.addEventListener('click', goToNextStage);
        restartButton.addEventListener('click', restartGame);

        function startGame() {
            gameState = {
                currentStage: 0,
                selectedCards: [],
                selectedActions: []
            };
            
            introSection.classList.add('hidden');
            gameStageSection.classList.remove('hidden');
            endingSection.classList.add('hidden');
            
            loadStage(gameState.currentStage);
        }

        function loadStage(stageIndex) {
            const stage = stages[stageIndex];
            
            // 스테이지 정보 업데이트
            stageTitle.innerHTML = `<h2 style="color: white; font-size: 2vw;">${stage.title}</h2>`;
            stageDescription.innerHTML = stage.description;
            
            // 초기 상태 설정
            storyText.classList.add('hidden');
            actionChoices.classList.add('hidden');
            gameContent.classList.remove('show');
            cardsContainer.classList.remove('selected-state');
            nextButton.disabled = true;
            
            // 카드 생성
            createCards(stage.cards);
        }

        function createCards(cardIds) {
            cardsContainer.innerHTML = '';
            
            cardIds.forEach(cardId => {
                const card = tarotCards.find(c => c.id === cardId);
                const cardElement = document.createElement('div');
                cardElement.className = 'card';
                cardElement.dataset.cardId = card.id;
                
                cardElement.innerHTML = `
                    <div class="card-inner">
                        <div class="card-back" style="background-image: url('${card.backImage}')"></div>
                        <div class="card-front" style="background-image: url('${card.frontImage}')"></div>
                    </div>
                `;
                
                cardElement.addEventListener('click', () => selectCard(cardElement, card.id));
                cardsContainer.appendChild(cardElement);
            });
        }

        function selectCard(cardElement, cardId) {
            // 이미 선택된 카드가 있으면 무시
            if (cardsContainer.querySelector('.card.selected')) {
                return;
            }
            
            // 카드 뒤집기 애니메이션
            cardElement.classList.add('flipped');
            cardElement.classList.add('selected');
            
            // 다른 카드들 완전히 숨기기
            const allCards = cardsContainer.querySelectorAll('.card');
            allCards.forEach(card => {
                if (card !== cardElement) {
                    setTimeout(() => {
                        card.classList.add('hidden');
                    }, 200); // 뒤집기 애니메이션 후 숨김
                }
            });
            
            // 레이아웃 변경
            setTimeout(() => {
                cardsContainer.classList.add('selected-state');
                showStoryAndActions(cardId);
            }, 600);
            
            // 게임 상태 업데이트
            gameState.selectedCards[gameState.currentStage] = cardId;
        }

        function showStoryAndActions(cardId) {
            const stage = stages[gameState.currentStage];
            
            // 스토리 텍스트 표시
            storyText.textContent = stage.stories[cardId];
            storyText.classList.remove('hidden');
            
            // 행동 선택지 생성
            actionChoices.innerHTML = '';
            const actions = stage.actions[cardId];
            
            actions.forEach((action, index) => {
                const actionElement = document.createElement('div');
                actionElement.className = 'action-choice';
                actionElement.textContent = action.text;
                
                actionElement.addEventListener('click', () => selectAction(actionElement, cardId, index));
                actionChoices.appendChild(actionElement);
            });
            
            actionChoices.classList.remove('hidden');
            gameContent.classList.add('show');
        }

        function selectAction(actionElement, cardId, actionIndex) {
            // 이미 선택된 행동이 있으면 선택 해제
            const selectedAction = actionChoices.querySelector('.action-choice.selected');
            if (selectedAction) {
                selectedAction.classList.remove('selected');
            }
            
            // 새 행동 선택
            actionElement.classList.add('selected');
            
            // 다음 버튼 활성화
            nextButton.disabled = false;
            
            // 게임 상태 업데이트
            gameState.selectedActions[gameState.currentStage] = actionIndex;
        }

        function goToNextStage() {
            gameState.currentStage++;
            
            if (gameState.currentStage < stages.length) {
                loadStage(gameState.currentStage);
            } else {
                showEnding();
            }
        }

        function showEnding() {
            gameStageSection.classList.add('hidden');
            endingSection.classList.remove('hidden');
            
            // 간단한 엔딩 메시지
            endingText.textContent = `축하합니다! 당신은 타이타닉의 운명을 바꿨습니다.\n당신의 현명한 선택들이 새로운 미래를 열었습니다.\n\n선택한 카드들: ${gameState.selectedCards.map(id => tarotCards.find(c => c.id === id)?.name).join(', ')}`;
        }

        function restartGame() {
            endingSection.classList.add('hidden');
            introSection.classList.remove('hidden');
        }
    </script>
</body>
</html>